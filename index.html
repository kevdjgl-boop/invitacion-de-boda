<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>María y Kevind | Nuestra Boda</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Montserrat:wght@300&family=Monsieur+La+Doulaise&family=Playfair+Display:wght@400&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    
    <script src="https://unpkg.com/lenis@1.3.11/dist/lenis.min.js"></script>
    <style>
      /* --- Reseteo y Estilos Globales --- */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* === CSS de Lenis === */
      html {
        scroll-behavior: auto !important;
      }
      html.lenis {
        height: auto;
      }
      .lenis.lenis-smooth {
        scroll-behavior: auto;
      }
      .lenis.lenis-smooth [data-lenis-prevent] {
        overscroll-behavior: contain;
      }
      .lenis.lenis-stopped {
        overflow: hidden;
      }
      /* === FIN CSS de Lenis === */

      html,
      body {
        width: 100%;
        font-family: "Fraunces", serif;
        font-weight: 400;
        color: #333;
        line-height: 1.6;

        background-color: hsla(0, 100%, 91%, 1);
        background-image: radial-gradient(
            at 99% 1%,
            hsla(28, 100%, 74%, 1) 0px,
            transparent 50%
          ),
          radial-gradient(
            at 0% 0%,
            hsla(340, 100%, 94%, 1) 0px,
            transparent 50%
          );
        animation: gradient 13s ease infinite;
        background-size: 200% 200%;
      }

      @keyframes gradient {
        0% {
          background-position: 0% 20%;
        }
        25% {
          background-position: 100% 50%;
        }
        50% {
          background-position: 50% 70%;
        }
        100% {
          background-position: 0% 20%;
        }
      }

      /* --- Estructura de Secciones --- */
      .invitation-hero {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        width: 100vw;
        position: relative;
        z-index: 10;
        padding: 4vh 5vw;
        gap: 2vh;
      }

      .details-page {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh; /* Altura mínima */
        width: 100vw;
        position: relative;
        z-index: 10;
        gap: 2vh;
      }

      .details-page-content {
        padding: 20vh 5vw;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2vh;
        width: 100%;
        position: relative;
        z-index: 10;
      }

      .hero-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2vh;
        width: 100%;
        position: relative;
        z-index: 10;
      }

      /* --- Hilo SVG Fijo --- */
      #curves-wrapper {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        overflow: hidden;
      }
      #curves-wrapper svg {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        preserveaspectratio: "xMidYMid slice";
      }
      .path {
        stroke: #f96d41;
        stroke-width: 1px;
        fill: none;
        opacity: 0; /* JS lo controla */
      }

      /* --- INICIALES DE FONDO --- */
      .initial-m,
      .initial-k,
      .initial-ampersand {
        position: fixed;
        font-family: "Playfair Display", serif;
        font-weight: 400;
        font-size: clamp(30rem, 50vmin, 40rem);
        line-height: 1;
        color: #333;
        opacity: 0.08;
        z-index: 5;
        pointer-events: none;
      }

      .initial-m {
        top: -15%;
        left: 55%;
        transform: translateX(-20%);
      }
      .initial-ampersand {
        font-family: "Fraunces", serif;
        font-size: clamp(20rem, 35vmin, 30rem);
        top: 35%;
        left: 50%;
        transform: translateX(-50%);
        line-height: 0.8;
      }
      .initial-k {
        bottom: -5%;
        left: 15%;
        transform: translateX(-50%);
      }

      /* --- Estilos de Texto (Responsivos) --- */
      header p {
        font-size: clamp(1rem, 3vw, 2rem);
        text-transform: uppercase;
        letter-spacing: 0.1em;
      }

      .names h1 {
        font-family: "Playfair Display", serif;
        font-weight: 400;
        font-size: clamp(5.5rem, 9vw, 7.2rem);
        line-height: 1.1;
        text-align: center;
      }

      .names span {
        font-family: "Monsieur La Doulaise", cursive;
        font-weight: 400;
        font-size: clamp(3.5rem, 6vw, 4rem);
        margin: 0;
        line-height: 1;
        display: block;
        text-align: center;
      }
      .request {
        font-size: clamp(1.3rem, 4vw, 1.6rem);
        margin-top: 2vh;
        line-height: 1.1;
        text-align: center;
      }

      /* --- CSS (Flores Responsivo) --- */
      .flower-divider {
        position: relative;
        width: 100%;
        height: 150px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1vh;
      }

      .flower-divider img {
        position: absolute;
        height: clamp(280px, 40vw, 380px);
        width: auto;
      }

      .flower-divider img:first-child {
        left: -20vw;
        top: 50%;
        transform: translateY(-50%) rotate(110deg);
      }

      .flower-divider img:last-child {
        right: -20vw;
        top: 10%;
        transform: translateY(-50%) rotate(-120deg);
      }
      /* --- FIN CSS (Flores) --- */

      .details {
        text-align: center;
      }
      .details .date {
        font-size: clamp(2.5rem, 5vw, 2.8rem);
        font-weight: 400;
        letter-spacing: 0.05em;
        margin-bottom: 1vh;
      }
      .details .time,
      .details .venue {
        font-size: clamp(1.2rem, 3vw, 1.3rem);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        line-height: 1.3;
      }
      .details .venue {
        margin-top: 0.5vh;
      }
      footer {
        line-height: 1.7;
        margin-top: 2vh;
        text-align: center;
      }
      footer p {
        font-size: clamp(0.9rem, 2.3vmin, 1.1rem);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      footer .rsvp,
      footer .gifts {
        font-size: clamp(0.9rem, 3vw, 1.1rem);
        text-transform: none;
        letter-spacing: 0;
        margin-top: 1.5vh;
        line-height: 1.5;
      }
      footer .rsvp strong {
        font-weight: 400;
        text-transform: uppercase;
      }

      footer .gifts a,
      footer .rsvp a.phone-link {
        color: inherit;
        text-decoration: underline;
      }

      /* Ocultar elementos para animar individualmente */
      .flower-divider img {
        /* GSAP controlará la opacidad y el transform */
      }
      
      .details-page-content .details,
      .details-page-content footer {
        opacity: 0;
        transform: translateY(30px);
      }
      
    </style>
  </head>
  <body>
    <div id="curves-wrapper">
      <svg
        width="100%"
        height="100%"
        viewBox="0 0 1630 1199"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          class="path"
          d="M1 311.317C173.786 140.493 611.135 -143.292 978.249 88.1616C1345.36 319.615 833.513 898.921 649.507 1040.22C465.502 1181.51 319.644 1242.37 272.52 1162.45C225.397 1082.52 392.573 980.476 583.31 898.921C774.048 817.366 1173.92 740.133 1629 898.921"
        />
        <path
          class="path"
          d="M1 898.921C173.786 1069.74 611.135 1313.53 978.249 1122.08C1345.36 890.626 833.513 311.317 649.507 170.021C465.502 28.7251 319.644 -32.1337 272.52 47.7885C225.397 127.711 392.573 229.757 583.31 311.317C774.048 392.872 1173.92 470.105 1629 311.317"
        />
        <path
          class="path"
          d="M1629 311.317C1456.21 482.141 1018.87 756.096 651.751 524.643C284.637 293.19 796.487 -286.115 978.249 -127.828C1164.49 33.4674 1310.36 94.3263 1357.48 14.4042C1404.6 94.4172 1237.43 196.463 1046.69 277.018C855.952 357.573 456.075 434.806 1 277.018"
        />
      </svg>
    </div>

    <section class="invitation-hero">
      <span class="initial-m">M</span>
      <span class="initial-ampersand">&</span>
      <span class="initial-k">K</span>

      <div class="hero-content">
        <header>
          <p>¡Dimos el "sí"!</p>
        </header>
        <div class="names">
          <h1>María</h1>
          <span>Y</span>
          <h1>Kevind</h1>
        </div>
        <p class="request">
          Queremos que seas testigo<br />
          de nuestro matrimonio civil.
        </p>
      </div>
    </section>

    <section class="details-page">
      <div class="details-page-content">
        <div class="flower-divider">
          <img src="flor_1.png" alt="Flor" />
          <img src="flor_2.png" alt="Flor" />
        </div>
        <section class="details">
          <p class="date">10ENE26</p>
          <p class="time">tres de la tarde</p>
          <p class="venue">
            Centro de recepciones PK2<br />
            Av. los paredones 201<br />
            primera cuadra Nazca
          </p>
        </section>
        <footer>
          <p>Recepción: A continuación de la ceremonia</p>
          <p>Código de Vestimenta: Elegante Cóctel</p>

          <p class="rsvp">
            <strong>R.S.V.P.:</strong> Agradecemos confirmar su asistencia
            <br />
            antes del 15/12/2025 al
            <a href="tel:+51977993344" class="phone-link">977993344</a>
          </p>

          <p class="gifts">
            Tu presencia es nuestro mejor regalo. <br />
          </p>
          <p class="gifts">
            Si además deseas tener un detalle,<br />
            puedes ver
            <a href="#link-a-la-lista-de-regalos"
              >nuestra lista de sugerencias</a
            >.
          </p>
        </footer>
      </div>
    </section>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // --- INICIO DE LA LÓGICA DE SCROLL ACTUALIZADA ---

        // 1. Registrar ScrollTrigger
        gsap.registerPlugin(ScrollTrigger);

        // === INICIO DE LA CORRECCIÓN: Código de Lenis actualizado ===
        // 2. Inicializar Lenis
        const lenis = new Lenis({
          duration: 1.2,
          easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), // https://www.desmos.com/calculator/brs54l4xou
          direction: 'vertical', // vertical, horizontal
          gestureDirection: 'vertical', // vertical, horizontal, both
          smooth: true,
          mouseMultiplier: 1,
          smoothTouch: false,
          touchMultiplier: 2,
          infinite: false,
        })

        //get scroll value
        lenis.on('scroll', ({ scroll, limit, velocity, direction, progress }) => {
          console.log({ scroll, limit, velocity, direction, progress })
        })

        function raf(time) {
          lenis.raf(time)
          requestAnimationFrame(raf)
        }

        requestAnimationFrame(raf)
        // === FIN DE LA CORRECCIÓN ===

        // --- PARTE 1: ANIMACIÓN DEL HILO (Sin cambios) ---
        const paths = gsap.utils.toArray(".path");
        let activePathIndex = -1;

        function animatePath(path) {
          if (!path) return;
          const pathLength = path.getTotalLength();
          const randomDuration = gsap.utils.random(2.5, 4);
          const randomScale = gsap.utils.random(0.9, 1.1);
          const randomRotation = gsap.utils.random(-10, 10);
          const overlapTime = randomDuration * 0.7;

          gsap.set(path, {
            strokeDasharray: pathLength + " " + pathLength,
            strokeDashoffset: pathLength,
            opacity: 1,
            scale: randomScale,
            rotation: randomRotation,
            transformOrigin: "center center",
          });

          gsap
            .timeline()
            .to(path, {
              strokeDashoffset: 0,
              duration: randomDuration,
              ease: "power2.in",
            })
            .to(
              path,
              {
                strokeDashoffset: -pathLength,
                duration: randomDuration,
                ease: "power2.out",
                onComplete: () => gsap.set(path, { opacity: 0 }),
              },
              `-=${overlapTime}`
            )
            .call(animateRandomPath);
        }

        function animateRandomPath() {
          let newPathIndex;
          do {
            newPathIndex = Math.floor(Math.random() * paths.length);
          } while (newPathIndex === activePathIndex);

          activePathIndex = newPathIndex;
          animatePath(paths[activePathIndex]);
        }

        animateRandomPath();

        // --- PARTE 2: LÍNEA DE TIEMPO (Actualizada) ---

        // 1. Animamos la entrada del "Hero"
        gsap.timeline({
            onComplete: createParallaxAnimation // Llama a la función de parallax al terminar
          })
          .from(
            ".hero-content header",
            { opacity: 0, scale: 0.3, y: "20vh", duration: 1.5, ease: "power3.out" },
            0.5
          )
          .from(
            ".hero-content .names",
            { opacity: 0, y: 30, duration: 1, ease: "power2.out" },
            "-=0.5"
          )
          .from(
            ".hero-content .request",
            { opacity: 0, y: 20, duration: 1, ease: "power2.out" },
            "-=0.5"
          );
        
        // 2. FUNCIÓN DE PARALLAX CON PINNING
        function createParallaxAnimation() {
          const parallaxTl = gsap.timeline({
            scrollTrigger: {
              trigger: ".invitation-hero",
              start: "top top",
              end: "bottom top", 
              scrub: 1,
              pin: true, 
              pinSpacing: false, 
            },
          });
          
          const finalProps = {
            yPercent: -150,
            opacity: 0,
            filter: "blur(5px)",
            ease: "power2.in"
          };
          
          parallaxTl
            .to(".hero-content header", finalProps)
            .to(".names h1:first-child", finalProps, "<0.25") // María
            .to(".names span", finalProps, "<0.25") // Y
            .to(".names h1:last-child", finalProps, "<0.25") // Kevind
            .to(".hero-content .request", finalProps, "<0.25"); // Mensaje
        }
        
        
        // 3. NUEVO: Animación de ENTRADA para los "Detalles"
        const detailsTl = gsap.timeline({
          scrollTrigger: {
            trigger: ".details-page",
            start: "top 60%", 
            end: "center 60%",
            scrub: 1.5,
          },
        });
        
        // Animamos la primera flor (izquierda)
        detailsTl.from(".flower-divider img:first-child", {
            yPercent: -50,
            opacity: 0, // Añadido para que aparezcan
            ease: "none", 
            duration: 1
        }, 0); 

        // Animamos la segunda flor (derecha) un poco después
        detailsTl.from(".flower-divider img:last-child", {
            yPercent: 50, 
            opacity: 0, // Añadido para que aparezcan
            ease: "none", 
            duration: 1
        }, 0.3); 

        // Animamos el resto del contenido
        detailsTl.to(".details-page-content .details, .details-page-content footer", {
            opacity: 1,
            y: 0,
            stagger: 0.2, 
            ease: "power3.out"
        }, 0.5); 
        
      });
    </script>
  </body>
</html>
